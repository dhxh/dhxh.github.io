<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>butterfly主题魔改</title>
      <link href="/2023/03/16/butterfly%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9/"/>
      <url>/2023/03/16/butterfly%E4%B8%BB%E9%A2%98%E9%AD%94%E6%94%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="一图流">一图流</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 页脚透明 */</span></span><br><span class="line"><span class="selector-id">#footer</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 页脚黑色透明玻璃效果移除 */</span></span><br><span class="line"><span class="selector-id">#footer</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/* 头图透明 */</span></span><br><span class="line"><span class="selector-id">#page-header</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 头图遮罩层透明 */</span></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/*top-img黑色透明玻璃效果移除，不建议加，除非你执着于完全一图流或者背景图对比色明显 */</span></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.post-bg</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*夜间模式伪类遮罩层透明*/</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#footer</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">      <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#page-header</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: transparent<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="卡片透明">卡片透明</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line"><span class="attr">--trans-light</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.88</span>);</span><br><span class="line"><span class="attr">--trans-dark</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.88</span>);</span><br><span class="line"><span class="attr">--border-style</span>: <span class="number">0px</span>;</span><br><span class="line"><span class="attr">--backdrop-filter</span>: <span class="built_in">blur</span>(<span class="number">5px</span>) <span class="built_in">saturate</span>(<span class="number">150%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 首页文章卡片 */</span></span><br><span class="line">  <span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">25px</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 首页侧栏卡片 */</span></span><br><span class="line">  <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">18px</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 文章页、归档页、普通页面 */</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#post</span>,</span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#page</span>,</span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#archive</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light);</span><br><span class="line"><span class="attribute">border</span>: <span class="built_in">var</span>(--border-style);</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attr">--border-style</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 导航栏 */</span></span><br><span class="line">  <span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#nav</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.88</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#nav</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 夜间模式遮罩 */</span></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span>,</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span>,</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#post</span>,</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#archive</span>,</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-tag">div</span><span class="selector-id">#page</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">var</span>(--trans-dark);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 阅读模式 */</span></span><br><span class="line">  <span class="selector-class">.read-mode</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">118</span>, <span class="number">238</span>, <span class="number">152</span>, <span class="number">0.5</span>) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.read-mode</span> <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">114</span>, <span class="number">227</span>, <span class="number">146</span>, <span class="number">0.5</span>) <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 夜间模式下的阅读模式 */</span></span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.read-mode</span> <span class="selector-id">#aside-content</span> <span class="selector-class">.card-widget</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.9</span>) <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.read-mode</span> <span class="selector-tag">div</span><span class="selector-id">#post</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">25</span>, <span class="number">25</span>, <span class="number">25</span>, <span class="number">0.9</span>) <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="鼠标样式">鼠标样式</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 鼠标样式 */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&quot;/style/img/default.cur&quot;</span>), default;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">img</span>,</span><br><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: <span class="built_in">url</span>(<span class="string">&quot;/style/img/pointer.cur&quot;</span>), default <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="加载动画">加载动画</h2><ol><li>修改 <code>themes/butterfly/layout/includes/loading/fullpage-loading.pug</code></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#loading-box(onclick=&#x27;document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)&#x27;)</span><br><span class="line">  .loading-bg</span><br><span class="line">    div.loading-img</span><br><span class="line">    .loading-image-dot</span><br><span class="line"></span><br><span class="line">script.</span><br><span class="line">  const preloader = &#123;</span><br><span class="line">    endLoading: () =&gt; &#123;</span><br><span class="line">      document.body.style.overflow = &#x27;auto&#x27;;</span><br><span class="line">      document.getElementById(&#x27;loading-box&#x27;).classList.add(&quot;loaded&quot;)</span><br><span class="line">    &#125;,</span><br><span class="line">    initLoading: () =&gt; &#123;</span><br><span class="line">      document.body.style.overflow = &#x27;&#x27;;</span><br><span class="line">      document.getElementById(&#x27;loading-box&#x27;).classList.remove(&quot;loaded&quot;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  window.addEventListener(&#x27;load&#x27;,()=&gt; &#123; preloader.endLoading() &#125;)</span><br><span class="line"></span><br><span class="line">  if (!&#123;theme.pjax &amp;&amp; theme.pjax.enable&#125;) &#123;</span><br><span class="line">    document.addEventListener(&#x27;pjax:send&#x27;, () =&gt; &#123; preloader.initLoading() &#125;)</span><br><span class="line">    document.addEventListener(&#x27;pjax:complete&#x27;, () =&gt; &#123; preloader.endLoading() &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>修改 <code>themes/butterfly/layout/includes/loading/index.pug</code></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if theme.preloader.source === 1</span><br><span class="line">  include ./fullpage-loading.pug</span><br><span class="line">else if theme.preloader.source === 2</span><br><span class="line">  include ./pace.pug</span><br><span class="line">else</span><br><span class="line">  include ./fullpage-loading.pug</span><br><span class="line">  include ./pace.pug</span><br></pre></td></tr></table></figure><ol start="3"><li>新建 <code>source/css/progress_bar.css</code></li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.pace</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  -webkit-user-select: none;</span><br><span class="line">  -moz-user-select: none;</span><br><span class="line">  user-select: none;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">4rem</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#eaecf2</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#e3e8f7</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace-inactive</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span> ease-in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span> <span class="selector-class">.pace-progress</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -moz-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -ms-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -o-<span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -moz-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  -o-<span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2000</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(-<span class="number">45deg</span>, <span class="number">#ee7752</span>, <span class="number">#e73c7e</span>, <span class="number">#23a6d5</span>, <span class="number">#23d5ab</span>);</span><br><span class="line">  <span class="attribute">animation</span>: gradient <span class="number">1.5s</span> ease infinite;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">200%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pace</span><span class="selector-class">.pace-inactive</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> gradient &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">100%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">background-position</span>: <span class="number">0%</span> <span class="number">50%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>修改 <code>themes/butterfly/source/css/_layout/loading.styl</code> ，注意其中颜色代码<code>--anzhiyu-card-bg</code> 等需自行替换为自己的色值。</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">if hexo-config(&#x27;preloader&#x27;)</span><br><span class="line">  <span class="selector-class">.loading-bg</span></span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-card-bg);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1001</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">transition</span>: .<span class="number">3s</span>;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#loading-box</span></span><br><span class="line">    <span class="selector-class">.loading-img</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">margin</span>: auto;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">4px</span> solid <span class="number">#f0f0f2</span>;</span><br><span class="line">      <span class="attribute">animation-duration</span>: .<span class="number">3s</span>;</span><br><span class="line">      <span class="attribute">animation-name</span>: loadingAction;</span><br><span class="line">      <span class="attribute">animation-iteration-count</span>: infinite;</span><br><span class="line">      <span class="attribute">animation-direction</span>: alternate;</span><br><span class="line">    <span class="selector-class">.loading-image-dot</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#6bdf8f</span>;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">6px</span> solid <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">18px</span>, <span class="number">24px</span>);</span><br><span class="line">    &amp;<span class="selector-class">.loaded</span></span><br><span class="line">      <span class="selector-class">.loading-bg</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: -<span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@keyframes</span> loadingAction</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">opacity</span>: .<span class="number">4</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>在合适的地方加上自定义 css, 其中 <code>background</code> 的 <code>url 即为 loading 的图片地址</code>。</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.loading-img</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">/style/img/logo.png</span>) no-repeat center center;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>修改 <code>_config.butterfly.yml</code>中 <code>preloader</code>选项。</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"># Loading <span class="attribute">Animation</span> (加载动画)</span><br><span class="line">preloader:</span><br><span class="line">  enable: true</span><br><span class="line">  # source</span><br><span class="line">  # <span class="number">1</span>. fullpage-loading</span><br><span class="line">  # <span class="number">2</span>. pace (progress bar)</span><br><span class="line">  # else all</span><br><span class="line">  source: <span class="number">3</span></span><br><span class="line">  # pace theme (see https://codebyzach.github.io/pace/)</span><br><span class="line">  pace_css_url: /css/progress_bar.css</span><br></pre></td></tr></table></figure><h2 id="昼夜切换动画">昼夜切换动画</h2><ol><li>新建 <code>themes/butterfly/layout/includes/sun_moon.pug</code></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">svg(aria-hidden=&#x27;true&#x27;, style=&#x27;position:absolute; overflow:hidden; width:0; height:0&#x27;)</span><br><span class="line">  symbol#icon-sun(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z&#x27;, fill=&#x27;#FFD878&#x27;, p-id=&#x27;8420&#x27;)</span><br><span class="line">    path(d=&#x27;M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z&#x27;, fill=&#x27;#FFE4A9&#x27;, p-id=&#x27;8421&#x27;)</span><br><span class="line">    path(d=&#x27;M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8422&#x27;)</span><br><span class="line">    path(d=&#x27;M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8423&#x27;)</span><br><span class="line">  symbol#icon-moon(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z&#x27;, fill=&#x27;#FFB531&#x27;, p-id=&#x27;11345&#x27;)</span><br><span class="line">    path(d=&#x27;M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z&#x27;, fill=&#x27;#030835&#x27;, p-id=&#x27;11346&#x27;)</span><br></pre></td></tr></table></figure><ol start="2"><li>新建 <code>themes/butterfly/source/css_layout/sun_moon.styl</code></li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.Cuteen_DarkSky</span>,</span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">  <span class="attribute">content</span> &#x27;&#x27;</span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">88888888</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">  <span class="attribute">background</span> linear-gradient(<span class="selector-id">#feb8b0</span>, <span class="selector-id">#fef9db</span>)</span><br><span class="line">  &amp;<span class="selector-pseudo">:before</span></span><br><span class="line">    <span class="attribute">transition</span> <span class="number">2s</span> ease <span class="attribute">all</span></span><br><span class="line">    <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">background</span> linear-gradient(<span class="selector-id">#4c3f6d</span>, <span class="selector-id">#6c62bb</span>, <span class="selector-id">#93b1ed</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.DarkMode</span></span><br><span class="line">  <span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">    &amp;<span class="selector-pseudo">:before</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">99999999</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">top</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">200%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">200%</span></span><br><span class="line">  -webkit-<span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> cubic-bezier(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> cubic-bezier(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">transform-origin</span> center <span class="attribute">bottom</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  &amp;<span class="selector-pseudo">:after</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">left</span> <span class="number">35%</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">40%</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">    <span class="attribute">content</span> &#x27;&#x27;</span><br><span class="line">    <span class="attribute">background</span> linear-gradient(<span class="selector-id">#fefefe</span>, <span class="selector-id">#fffbe8</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span></span><br><span class="line">  <span class="selector-tag">span</span></span><br><span class="line">    <span class="attribute">display</span> <span class="attribute">none</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menus_item</span></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">text-decoration</span> <span class="attribute">none</span>!important</span><br><span class="line">//按钮相关，对侧栏按钮做过魔改的可以调整这里的数值</span><br><span class="line"><span class="selector-class">.icon-V</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure><ol start="3"><li>新建 <code>source/js/sun_moon.js</code></li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">switchNightMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;beforeend&#x27;</span>, <span class="string">&#x27;&lt;div class=&quot;Cuteen_DarkSky&quot;&gt;&lt;div class=&quot;Cuteen_DarkPlanet&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>),</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;DarkMode&#x27;</span>) ? (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;0&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)) : (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)),</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;opacity 3s&#x27;</span>;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">          <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="title function_">remove</span>();</span><br><span class="line">          &#125;, <span class="number">1e3</span>);</span><br><span class="line">        &#125;, <span class="number">2e3</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">const</span> nowMode = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (nowMode === <span class="string">&#x27;light&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">activateDarkMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;dark&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span> &amp;&amp; btf.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">day_to_night</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">activateLightMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// handle some cases</span></span><br><span class="line">  <span class="keyword">typeof</span> utterancesTheme === <span class="string">&#x27;function&#x27;</span> &amp;&amp; <span class="title function_">utterancesTheme</span>()</span><br><span class="line">  <span class="keyword">typeof</span> <span class="variable constant_">FB</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">loadFBComment</span>()</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">DISQUS</span> &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;disqus_thread&#x27;</span>).<span class="property">children</span>.<span class="property">length</span> &amp;&amp; <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">disqusReset</span>(), <span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>修改 <code>themes/butterfly/layout/includes/head.pug</code></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//- 昼夜模式切换动画</span><br><span class="line">include ./sun_moon.pug</span><br></pre></td></tr></table></figure><ol start="6"><li>修改 <code>themes/butterfly/layout/includes/rightside.pug</code></li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  when &#x27;translate&#x27;</span><br><span class="line">    if translate.enable</span><br><span class="line">      button#translateLink(type=&quot;button&quot; title=_p(&#x27;rightside.translate_title&#x27;))= translate.default</span><br><span class="line">  when &#x27;darkmode&#x27;</span><br><span class="line">    if theme.darkmode.enable &amp;&amp; theme.darkmode.button</span><br><span class="line">-     button#darkmode(type=&quot;button&quot; title=_p(&#x27;rightside.night_mode_title&#x27;))</span><br><span class="line">-       i.fas.fa-adjust</span><br><span class="line">+     a.icon-V.hidden(onclick=&#x27;switchNightMode()&#x27;,  title=_p(&#x27;rightside.night_mode_title&#x27;))</span><br><span class="line">+       svg(width=&#x27;25&#x27;, height=&#x27;25&#x27;, viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">+         use#modeicon(xlink:href=&#x27;#icon-moon&#x27;)</span><br></pre></td></tr></table></figure><ol start="7"><li>引入 <code>butterfly_config.yml</code></li></ol><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;/js/sun_moon.js&quot;</span> <span class="string">async&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 日常笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows安全加固</title>
      <link href="/2022/12/14/windows%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"/>
      <url>/2022/12/14/windows%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="一、账户">一、账户</h2><h3 id="1、默认账户安全">1、默认账户安全</h3><ul><li>禁用Guest账户。</li><li>禁用或删除无用账户</li><li>Administartor 账户 组重名。</li></ul><h3 id="2、账号安全策略">2、账号安全策略</h3><ul><li>密码复杂度</li><li>密码最小长度</li><li>密码最长使用期限</li><li>强制密码历史</li></ul><h3 id="3、账号锁定策略">3、账号锁定策略</h3><ul><li>账号锁定阈值</li><li>账号锁定时间</li><li>重置账户锁定计数器</li></ul><h2 id="二、日志及审核策略">二、日志及审核策略</h2><ul><li>对重要事件进行审核 审核策略 启用成功和失败</li><li>调整事件日志大小及日志满时存档</li></ul><h2 id="三、文件权限">三、文件权限</h2><ul><li>关闭默认共享</li><li>共享文件夹取消Everyone</li><li>系统分区仅administrator、system完全控制</li><li>注册表 仅管理员控制，其他用户仅读</li></ul><h2 id="四、安全选项">四、安全选项</h2><ul><li>根据需要禁用不必要的服务</li><li>根据需要启用安全选项(例)<ul><li>不允许SAM账户和共享的匿名枚举</li><li>不允许SAM账户的的匿名枚举</li><li>可匿名访问的共享</li><li>可匿名访问的命名管道<br>可远程访问的注册表路径</li><li>拒绝本地登录</li><li>从网络访问此计算机</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全服务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux应急响应</title>
      <link href="/2022/12/11/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
      <url>/2022/12/11/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</url>
      
        <content type="html"><![CDATA[<h2 id="一、账户">一、账户</h2><ul><li>用户信息文件<ul><li>/etc/passwd</li><li>/etc/shadow</li><li>/etc/group</li></ul></li><li>who 查看当前登录用户</li><li>w 查看系统信息，某一刻用户行为</li><li>uptime 查看登录多久、多少用户、负载状态</li></ul><h3 id="1、是否为弱口令">1、是否为弱口令</h3><h3 id="2、查询是否有可疑账户">2、查询是否有可疑账户</h3><ul><li>cat /etc/passwd</li></ul><h3 id="3、-查询特权用户">3、 查询特权用户</h3><ul><li><code>awk -F: '$3==0&#123;print $1&#125;' /etc/passwd</code></li></ul><h3 id="4、查询可疑远程登录的账号">4、查询可疑远程登录的账号</h3><ul><li><code>awk '/\$1|\$6/&#123;print $1&#125;' /etc/shadow</code></li></ul><h3 id="5、查看sudo权限的用户">5、查看sudo权限的用户</h3><ul><li><code>cat /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</code></li></ul><h3 id="6、公私钥免密登录">6、公私钥免密登录</h3><ul><li>查看/root/.ssh/authorized_keys是否修改。</li></ul><h3 id="7、日志">7、日志</h3><ul><li>日志默认位置 /var/log</li><li>日志配置 /etc/rsyslog.conf</li></ul><table><thead><tr><th style="text-align:left">日志文件</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left">/var/log/cron</td><td style="text-align:left">记录了系统定时任务相关的日志</td></tr><tr><td style="text-align:left">/var/log/cups</td><td style="text-align:left">记录了打印信息的日志</td></tr><tr><td style="text-align:left">/var/log/dmesg</td><td style="text-align:left">记录了系统开机时内核自检信息。</td></tr><tr><td style="text-align:left">/var/log/message</td><td style="text-align:left">记录了系统重要信息的日志。</td></tr><tr><td style="text-align:left">/var/log/btmp</td><td style="text-align:left">记录了错误登录日志</td></tr><tr><td style="text-align:left">/var/log/lastlog</td><td style="text-align:left">记录了所有用户最后一次登录时间的日志</td></tr><tr><td style="text-align:left">/var/log/wtmp</td><td style="text-align:left">永久记录所有用户的登录、注销，同时记录系统启动、重启、关机事件。</td></tr><tr><td style="text-align:left">/var/log/utmp</td><td style="text-align:left">记录了当前已经登录的用户信息</td></tr><tr><td style="text-align:left">/var/log/secure</td><td style="text-align:left">记录验证和授权方面的信息，涉及账号和密码的程序都会记录</td></tr></tbody></table><h2 id="二、历史命令">二、历史命令</h2><ul><li><code>cat /root/.bash_history</code></li><li><code>cat /home/$USER/.bash_history</code></li></ul><h2 id="三、端口和进程">三、端口和进程</h2><h3 id="1、检查是否有异常连接的端口">1、检查是否有异常连接的端口</h3><ul><li><code>netstat -antlp</code></li><li><code>ls -l /proc/$PID/exe</code></li><li><code>lsof -i:port</code></li></ul><h3 id="2、检查异常进程">2、检查异常进程</h3><ul><li>注意事项<ul><li>有没有命名奇怪的进程</li><li>注意cpu占用</li><li>kill -9 PID后是否重启复活</li></ul></li><li>检查方法<ul><li><code>ps -aux</code></li><li><code>lsof -p PID</code></li><li>工具unhide</li></ul></li></ul><h2 id="四、开机启动、计划任务、服务">四、开机启动、计划任务、服务</h2><h3 id="1、开机启动项">1、开机启动项</h3><ul><li>开机启动目录<ul><li>/etc/init.d/</li><li>/etc/rc.local</li><li>/etc/rc.d/rc[0~6].d</li></ul></li></ul><h3 id="2、计划任务">2、计划任务</h3><ul><li>计划任务目录<ul><li>/var/spool/cron/</li><li>/var/spool/anacron</li><li>/etc/crontab</li><li>/etc/cron.d</li><li>/etc/cron.daily</li><li>/etc/cron.hourly</li><li>/etc/cron.monthly</li><li>/etc/cron.weekly</li><li>/etc/anacrontab</li></ul></li></ul><h3 id="3、服务">3、服务</h3><ul><li>服务自启动<ul><li><p>chkconfig</p><ul><li><code>chkconfig -add</code> 增加服务</li><li><code>chkconfig -del</code> 删除服务</li></ul></li><li><p>systemctl</p><ul><li><code>systemctl list-unit-file</code> 查看服务开机启动状态</li><li><code>systemctl enable</code> 开启服务开机启动</li><li><code>systemctl disable</code> 关闭服务开机启动</li></ul></li><li><p>加入开机启动目录</p></li></ul></li></ul><h2 id="五、系统信息">五、系统信息</h2><h3 id="1、可疑目录和文件">1、可疑目录和文件</h3><ul><li>检查敏感目录<ul><li>/tmp</li><li>/var/tmp</li><li>/usr/tmp</li></ul></li><li>find 查找最近修改过的文件<ul><li><code>find ./ -name '*' -mmin -60</code> 查找60分钟内修改的文件</li><li><code>find ./ -name '*' -mtime 0</code> 查找24小时内修改的文件</li><li><code>find ./ -ctime -2</code> 查找48小时内修改的文件</li></ul></li><li>find 指定时间段内修改的文件<ul><li><code>find ./ -newer file1 ! -newer file2</code> 列出比file新比file2旧的文件</li></ul></li><li>find 查找特殊权限的文件<ul><li><code>find / -perm -4000</code></li><li><code>find / -perm -u=s -type f 2&gt;/dev/null </code></li></ul></li><li>start 确认可疑文件时间</li></ul><h3 id="2、系统环境变量">2、系统环境变量</h3><ul><li><code>echo $PATH</code></li></ul><h3 id="3、命令替换排查">3、命令替换排查</h3><ul><li>执行一些命令参数，检查是否被替换</li><li>检查md5sum和文件大小</li><li><code>ls -lat</code> 按时间排序查看是否有修改的痕迹</li></ul><h2 id="六、github应急响应资源">六、github应急响应资源</h2><ul><li><a href="https://github.com/al0ne/LinuxCheck">https://github.com/al0ne/LinuxCheck</a></li><li><a href="https://github.com/grayddq/GScan">https://github.com/grayddq/GScan</a></li><li><a href="https://github.com/starnightcyber/Emergency-Material-Collection">https://github.com/starnightcyber/Emergency-Material-Collection</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全服务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows应急响应</title>
      <link href="/2022/12/11/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
      <url>/2022/12/11/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</url>
      
        <content type="html"><![CDATA[<h2 id="一、账号">一、账号</h2><h3 id="1、弱口令">1、弱口令</h3><ul><li>查看服务器是否存在弱口令</li></ul><h3 id="2、可疑账号">2、可疑账号</h3><ul><li>禁用或者删除对应账户</li></ul><h3 id="3、隐藏账号">3、隐藏账号</h3><ul><li>检查注册表对应键值 HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account</li></ul><h2 id="二、端口和进程">二、端口和进程</h2><h3 id="1、检查端口连接">1、检查端口连接</h3><ul><li>netstat -ano 查看目前的网络连接，定位可疑的连接和端口。</li><li>根据查询到的pid定位到进程，tasklist /svc | findstr $pid</li></ul><h3 id="3、检查异常进程">3、检查异常进程</h3><ul><li>msinfo32 -&gt; 正在运行任务</li><li>任务管理器</li></ul><h3 id="4、快速定位恶意进程">4、快速定位恶意进程</h3><ul><li>没有签名验证信息的进程</li><li>没有描述信息的进程</li><li>进程的属主</li><li>进程路径是否合法</li><li>cpu或内存资源占用时间过高的进程</li></ul><h3 id="5、快速定位进程目录">5、快速定位进程目录</h3><ul><li>msinfo32</li><li>wmic -&gt; process</li><li>任务管理器</li></ul><h2 id="三、开机启动项-、计划任务、服务">三、开机启动项 、计划任务、服务</h2><h3 id="1、开机启动项">1、开机启动项</h3><ul><li>开机启动目录<ul><li><code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code></li><li><code>C:\Users\xxx\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code></li></ul></li><li>注册表目录<ul><li><code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code></li><li><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code></li><li><code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</code></li><li>Logon Scripts后门 <code>HKEY_CURRENT_USER\Environment\UserInitMprLogonScript</code></li><li>userinit后门 <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit </code></li></ul></li></ul><h3 id="2、计划任务">2、计划任务</h3><ul><li>任务计划程序 或 schtasks</li></ul><h3 id="3、服务">3、服务</h3><ul><li>services.msc 检查服务状态和启动类型，检查是否有异常服务。</li></ul><h3 id="4、工具">4、工具</h3><ul><li>Autoruns</li></ul><h2 id="四、系统信息">四、系统信息</h2><h3 id="1、系统补丁">1、系统补丁</h3><ul><li>systeminfo 查看是否有相应可用漏洞</li></ul><h3 id="2、可疑目录和文件">2、可疑目录和文件</h3><ul><li>最近打开文件 <code>C:\Users\xxx\Recent</code></li><li>各个目录，寻找最近更新过的文件</li><li>修改时间在创建时间之前的可疑文件</li><li>ADS隐藏文件 <code>dir /r</code></li><li>回收站、浏览器下载和历史记录</li><li>temp临时目录</li></ul><h2 id="五、日志分析">五、日志分析</h2><h3 id="1、事件id">1、事件id</h3><table><thead><tr><th style="text-align:center">事件ID</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:center">4624</td><td style="text-align:left">登录成功</td></tr><tr><td style="text-align:center">4625</td><td style="text-align:left">登录失败</td></tr><tr><td style="text-align:center">4634</td><td style="text-align:left">注销成功</td></tr><tr><td style="text-align:center">4647</td><td style="text-align:left">用户发起注销</td></tr><tr><td style="text-align:center">4672</td><td style="text-align:left">管理员登陆</td></tr><tr><td style="text-align:center">4620</td><td style="text-align:left">创建用户</td></tr></tbody></table><h3 id="2、登录类型">2、登录类型</h3><table><thead><tr><th style="text-align:center">登录类型</th><th style="text-align:left">描述</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:center">2</td><td style="text-align:left">C（Interactive）</td><td style="text-align:left">用户在本地登录。</td></tr><tr><td style="text-align:center">3</td><td style="text-align:left">网络（Network）</td><td style="text-align:left">常见于连接到共享文件夹或共享打印机时。</td></tr><tr><td style="text-align:center">4</td><td style="text-align:left">批处理（Batch）</td><td style="text-align:left">通常表明某计划任务启动。</td></tr><tr><td style="text-align:center">5</td><td style="text-align:left">服务（Service）</td><td style="text-align:left">每种服务都被配置在特定的用户账号下运行。</td></tr><tr><td style="text-align:center">7</td><td style="text-align:left">解锁（Unlock）</td><td style="text-align:left">屏保解锁。</td></tr><tr><td style="text-align:center">8</td><td style="text-align:left">网络明文</td><td style="text-align:left">登录的密码在网络上是通过明文传输的。</td></tr><tr><td style="text-align:center">9</td><td style="text-align:left">新凭证（NewCredentials）</td><td style="text-align:left">使用带/Netonly参数的RUNAS命令运行一个程序。</td></tr><tr><td style="text-align:center">10</td><td style="text-align:left">远程交互</td><td style="text-align:left">屏保解锁。</td></tr><tr><td style="text-align:center">11</td><td style="text-align:left">缓存交互</td><td style="text-align:left">屏保解锁。</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全服务 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
